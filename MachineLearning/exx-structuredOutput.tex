\input{../latex/shared}

\renewcommand{\course}{Machine Learning}
\renewcommand{\exnum}{5}

\exercises
\excludecomment{solution}
\exercisestitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\exsection{Structured Output: mixed classification/regression}

\emph{Note:} The following two exercises are meant to train you in
modelling structured output. The generic application case would be
time series tagging or image segmentation. However, for both of these
applications defining features and computing the $\argmax_y f(x,y)$ is
non-trivial. So, for the sake of simplicity of the exercises I
describe some made up 'toy' problems.

~

\begin{figure}
\show[.4]{dataMixedCRF_x_y2.png}
\end{figure}

Consider a data set of tuples $(x,y_1,y_2)$ where
\begin{itemize}
\item $x\in\RRR$ is the age of a machine in some factory
\item $y_1\in\{0,1\}$ is a binary indicator whether some piece of the
  machine got loose or broke
\item $y_2\in\RRR$ is the performance of the machine (perhaps the
  rate of correct production/assembly or so).
\end{itemize}
The figure displays the data $(x,y_2)$, which looks like two curves to
be fit. These two curves correspond to $y_1\in\{0,1\}$.

a) Properly define a \emph{representation} and \emph{objective} for
modelling the prediction $x \mapsto (y_1, y_2)$.

b) Implement the method. What is your prediction for $x=80$, that is,
what is the probability $P(y_1 \| x=80)$ of a broken piece and,
conditionally to that, your prediction of performance $y_2$
conditional to $(y_1, x=80)$, i.e., for both cases $y_1\in\{0,1\}$?

\exerfoot
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\exsection{Labelling a time series*}

Assume we are in a clinical setting. Several sensors measure
different things of a patient, like heart beat rate, blood pressure,
EEG signals. These measurements form a vector $x_t\in\RRR^n$ for every
time step $t=1,..,T$.

A doctor wants to annotate such time series with a binary label that
indicates whether the patient was asleep. Your job is to develop a ML
algorithm to automatically annotate such data. For this assume that
the doctor has already annotated several time series of different
patients: you are given the training data set
$$ D = \{ (x^i_{1:T}, y^i_{1:T}) \}_{i=1}^n \comma x^i_t\in\RRR^n,~
y^i_t\in\{0,1\} $$
where the superscript $i$ denotes the data instance, and the subscript
$t$ the time step (e.g., each step could correspond to 10 seconds).

Develop a ML algorithms to do this job. First specify the model
formally in all details (representation \& objective). Then detail the
algorithm to compute optimal parameters in pseudo code, being as
precise as possible in all respects. Finally, don't forget to sketch
an algorithm to actually do the annotation given an input $x^i_{1:T}$
and optimized parameters.

(No need to actually implement.)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\exerfoot
